{% extends 'main/content.html' %}
{% load static %}
{% block title %}
2.3. Параметры представлений
{% endblock %}
    {% block head %}Параметры представлений{% endblock %}
{% block content %}
    <p>Функции-представления могут принимать параметры, через которые могут передаваться различные данные. Подобный параметры передаются в 
    в адресе URL. Например, в запросе <em>http://localhost/index/3/5/</em>поледние два сегмента <code>3/5/</code> могут представлять 
    параметры URL, которые могут быть связанны с параметрами функции-представления через систему маршрутизации.</p>
    <h3>Определение параметров через функцию re_path</h3>
    <p>Определим в приложении в файле <strong>views.py</strong> следующие функции:</p>
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div><div id="highlighter_472245" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help"></a></strong></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">from</code> <code class="py plain">django.http </code><code class="py keyword">import</code> <code class="py plain">HttpResponse</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="py keyword">def</code> <code class="py plain">products(request, productid):</code></div><div class="line number4 index3 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">output </code><code class="py keyword">=</code> <code class="py string">"&lt;h2&gt;Product № {0}&lt;/h2&gt;"</code><code class="py plain">.</code><code class="py functions">format</code><code class="py plain">(productid)</code></div><div class="line number5 index4 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py plain">HttpResponse(output)</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="py keyword">def</code> <code class="py plain">users(request, </code><code class="py functions">id</code><code class="py plain">, name):</code></div><div class="line number8 index7 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">output </code><code class="py keyword">=</code> <code class="py string">"&lt;h2&gt;User&lt;/h2&gt;&lt;h3&gt;id: {0}&nbsp; name: {1}&lt;/h3&gt;"</code><code class="py plain">.</code><code class="py functions">format</code><code class="py plain">(</code><code class="py functions">id</code><code class="py plain">, name)</code></div><div class="line number9 index8 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py plain">HttpResponse(output)</code></div></div></td></tr></tbody></table></div></div>
    </nav>
    <p>Функция products кроме параметра request принимает также параметр productid - условный номер товара. Отправляемый пользователю ответ содержит 
    значение этого параметра.</p>
    <p>Функция users принимает два дополнительных параметра: id и name - условные идентификатор и имя пользователя. И подобным образом эти данные 
    отправляются обратно пользователю.</p>
    <p>Теперь изменим файл <strong>urls.py</strong>, чтобы он мог сопоставить данные функции с запросами:</p>
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div><div id="highlighter_680726" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help"></a></strong></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">from</code> <code class="py plain">django.urls </code><code class="py keyword">import</code> <code class="py plain">re_path</code></div><div class="line number2 index1 alt1"><code class="py keyword">from</code> <code class="py plain">firstapp </code><code class="py keyword">import</code> <code class="py plain">views</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="py plain">urlpatterns </code><code class="py keyword">=</code> <code class="py plain">[</code></div><div class="line number5 index4 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">re_path(r</code><code class="py string">'^products/(?P&lt;productid&gt;\d+)/'</code><code class="py plain">, views.products),</code></div><div class="line number6 index5 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">re_path(r</code><code class="py string">'^users/(?P&lt;id&gt;\d+)/(?P&lt;name&gt;\D+)/'</code><code class="py plain">, views.users),</code></div><div class="line number7 index6 alt2"><code class="py plain">]</code></div></div></td></tr></tbody></table></div></div>
    </nav>
    <p>Для представления параметра в шаблоне адреса используется выражение <code>?P&lt;&gt;</code>. Общее определение параметру соответствует формату 
    <code>(?P&lt;имя_параметра&gt;регулярное_выражение)</code>. Между угловыми скобками помещается название параметра. 
    После закрывающей угловой скобки идет регулярное выражение, которому дожно соответствовать значение параметра.</p>
    <p>Например, <code>?P&lt;productid&gt;\d+</code> указывает, что параметр называется <code>productid</code>, и он должен соответствовать регулярному выражению 
    <code>\d+</code>, то есть представлять последовательность цифр.</p>
    <p>Во втором шаблоне адреса определяются два параметра: id и name (<code>(?P&lt;id&gt;\d+)/(?P&lt;name&gt;\D+)</code>). 
    При этом параметр id должен представлять число, а параметр name должен состоять только из буквенных символов.</p>
    <p>Ну и также отметим, что количество и название параметров в шаблонах адресов URL соответствуют количеству и названиям параметров соответствующих функций, которые 
    обрабатывают запросы по данным адресам.</p>
    <p>Теперь мы можем чем адресную строку передать данные в приложение:</p>
    <img class="displayed" src="{% static "images/2/3.6.png" %}" alt="site logo" >
    <img class="displayed" src="{% static "images/2/3.7.png" %}" alt="site logo" >
    <p>Однако, что если мы не передадим значение для параметра или передадим ему значение, которое не соответствует регулярному выражению? В этом 
    случае система не смодет найти ресурс для обработки запроса:</p>
    <img class="displayed" src="{% static "images/2/3.8.png" %}" alt="site logo" >
    <p>В этом случае мы можем определить в файле <strong>views.py</strong> для параметра функции products значение параметра по умолчанию:</p>
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div><div id="highlighter_618734" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help"></a></strong></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">def</code> <code class="py plain">products(request, productid </code><code class="py keyword">=</code> <code class="py value">21</code><code class="py plain">):</code></div><div class="line number2 index1 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">output </code><code class="py keyword">=</code> <code class="py string">"&lt;h2&gt;Product № {0}&lt;/h2&gt;"</code><code class="py plain">.</code><code class="py functions">format</code><code class="py plain">(productid)</code></div><div class="line number3 index2 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py plain">HttpResponse(output)</code></div></div></td></tr></tbody></table></div></div>
    </nav>
    <p>То есть если в функцию не передается значение для параметра productid, то он получает значение 21.</p>
    <p>В этом случае надо дополнительно определить еще один маршрут в файле <strong>urls.py</strong>:</p>
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div><div id="highlighter_59504" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help"></a></strong></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">from</code> <code class="py plain">django.urls </code><code class="py keyword">import</code> <code class="py plain">re_path</code></div><div class="line number2 index1 alt1"><code class="py keyword">from</code> <code class="py plain">firstapp </code><code class="py keyword">import</code> <code class="py plain">views</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="py plain">urlpatterns </code><code class="py keyword">=</code> <code class="py plain">[</code></div><div class="line number5 index4 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">re_path(r</code><code class="py string">'^products/$'</code><code class="py plain">, views.products),</code></div><div class="line number6 index5 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">re_path(r</code><code class="py string">'^products/(?P&lt;productid&gt;\d+)/'</code><code class="py plain">, views.products),</code></div><div class="line number7 index6 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number8 index7 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">re_path(r</code><code class="py string">'^users/(?P&lt;id&gt;\d+)/(?P&lt;name&gt;\D+)/'</code><code class="py plain">, views.users),</code></div><div class="line number9 index8 alt2"><code class="py plain">]</code></div></div></td></tr></tbody></table></div></div>
    </nav>
    <h3>Определение параметров через функцию path</h3>
    <p>Возьмем те же функции в файле <strong>views.py</strong>:</p>
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div><div id="highlighter_328583" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help"></a></strong></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">from</code> <code class="py plain">django.http </code><code class="py keyword">import</code> <code class="py plain">HttpResponse</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="py keyword">def</code> <code class="py plain">products(request, productid):</code></div><div class="line number4 index3 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">output </code><code class="py keyword">=</code> <code class="py string">"&lt;h2&gt;Product № {0}&lt;/h2&gt;"</code><code class="py plain">.</code><code class="py functions">format</code><code class="py plain">(productid)</code></div><div class="line number5 index4 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py plain">HttpResponse(output)</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="py keyword">def</code> <code class="py plain">users(request, </code><code class="py functions">id</code><code class="py plain">, name):</code></div><div class="line number8 index7 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">output </code><code class="py keyword">=</code> <code class="py string">"&lt;h2&gt;User&lt;/h2&gt;&lt;h3&gt;id: {0}&nbsp; name: {1}&lt;/h3&gt;"</code><code class="py plain">.</code><code class="py functions">format</code><code class="py plain">(</code><code class="py functions">id</code><code class="py plain">, name)</code></div><div class="line number9 index8 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py plain">HttpResponse(output)</code></div></div></td></tr></tbody></table></div></div>
    </nav>
    <p>Определение параметров с помощью функции <code>path()</code> будет выглядеть следующим образом:</p>
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div><div id="highlighter_106278" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help"></a></strong></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">from</code> <code class="py plain">django.urls </code><code class="py keyword">import</code> <code class="py plain">path</code></div><div class="line number2 index1 alt1"><code class="py keyword">from</code> <code class="py plain">firstapp </code><code class="py keyword">import</code> <code class="py plain">views</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="py plain">urlpatterns </code><code class="py keyword">=</code> <code class="py plain">[</code></div><div class="line number5 index4 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">path(</code><code class="py string">'products/&lt;int:productid&gt;/'</code><code class="py plain">, views.products),</code></div><div class="line number6 index5 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">path(</code><code class="py string">'users/&lt;int:id&gt;/&lt;name&gt;/'</code><code class="py plain">, views.users),</code></div><div class="line number7 index6 alt2"><code class="py plain">]</code></div></div></td></tr></tbody></table></div></div>
    </nav>
    <p>Параметры заключаются в угловые скобки в формате <code>&lt;спецификатор:название_параметра&gt;</code>. Например, в первом маршруте 
    параметр productid имеет спецификатор <strong>int</strong>.</p>
    <p>По умолчанию Django предоставляет следующие спецификаторы:</p>
    <ul>
    <li><p><strong>str</strong>: соответствует любой строке за исключенем символа "/". Если спецификатор не указан, то используется по умолчанию</p></li>
    <li><p><strong>int</strong>: соответствует любому положительному числу</p></li>
    <li><p><strong>slug</strong>: соответствует последовательности буквенных символов ASCII, цифр, дефиса и символа подчеркивания, 
    например, <code>building-your-1st-django-site</code></p></li>
    <li><p><strong>uuid</strong>: сооветствует идентификатору UUID, например, <code>075194d3-6885-417e-a8a8-6c931e272f00</code></p></li>
    <li><p><strong>path</strong>: соответствует любой строке, которая также может включать символ "/" в отличие от спецификатора str</p></li>
    </ul>
    <h4>Значения для параметров по умолчанию</h4>
    <p>Определеним для функций в <strong>views.py</strong> значения для параметров по умолчанию:</p>
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div><div id="highlighter_536252" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help"></a></strong></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">from</code> <code class="py plain">django.http </code><code class="py keyword">import</code> <code class="py plain">HttpResponse</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="py keyword">def</code> <code class="py plain">products(request, productid</code><code class="py keyword">=</code><code class="py value">3</code><code class="py plain">):</code></div><div class="line number4 index3 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">output </code><code class="py keyword">=</code> <code class="py string">"&lt;h2&gt;Product № {0}&lt;/h2&gt;"</code><code class="py plain">.</code><code class="py functions">format</code><code class="py plain">(productid)</code></div><div class="line number5 index4 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py plain">HttpResponse(output)</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="py keyword">def</code> <code class="py plain">users(request, </code><code class="py functions">id</code><code class="py keyword">=</code><code class="py value">1</code><code class="py plain">, name</code><code class="py keyword">=</code><code class="py string">"Bob"</code><code class="py plain">):</code></div><div class="line number8 index7 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">output </code><code class="py keyword">=</code> <code class="py string">"&lt;h2&gt;User&lt;/h2&gt;&lt;h3&gt;id: {0}&nbsp; name: {1}&lt;/h3&gt;"</code><code class="py plain">.</code><code class="py functions">format</code><code class="py plain">(</code><code class="py functions">id</code><code class="py plain">, name)</code></div><div class="line number9 index8 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py plain">HttpResponse(output)</code></div></div></td></tr></tbody></table></div></div>
    </nav>
    <p>В этом случае для каждой функции надо определить по два маршрута:</p>
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div><div id="highlighter_931966" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help"></a></strong></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">from</code> <code class="py plain">django.urls </code><code class="py keyword">import</code> <code class="py plain">path</code></div><div class="line number2 index1 alt1"><code class="py keyword">from</code> <code class="py plain">firstapp </code><code class="py keyword">import</code> <code class="py plain">views</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="py plain">urlpatterns </code><code class="py keyword">=</code> <code class="py plain">[</code></div><div class="line number5 index4 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">path(</code><code class="py string">'products/'</code><code class="py plain">, views.products),</code></div><div class="line number6 index5 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">path(</code><code class="py string">'products/&lt;int:productid&gt;/'</code><code class="py plain">, views.products),</code></div><div class="line number7 index6 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number8 index7 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">path(</code><code class="py string">'users/'</code><code class="py plain">, views.users),</code></div><div class="line number9 index8 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">path(</code><code class="py string">'users/&lt;int:id&gt;/&lt;str:name&gt;/'</code><code class="py plain">, views.users),</code></div><div class="line number10 index9 alt1"><code class="py plain">]</code></div></div></td></tr></tbody></table></div></div>
    </nav>
    
{% endblock %}
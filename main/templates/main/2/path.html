{% extends 'main/content.html' %}
{% load static %}
{% block title %}
2.2. Определение маршрутов и функции path и re_path
{% endblock %}
    {% block head %}Определение маршрутов и функции path и re_path{% endblock %}
{% block content %}   
    <p>В прошлой теме рассматривалось сопоставление адресов URL и функций, которые обрабатывают запросы по этим адресам. Например, у нас есть 
    следующие функции в файле <strong>views.py</strong>:</p>
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div><div id="highlighter_418413" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help"></a></strong></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">from</code> <code class="py plain">django.http </code><code class="py keyword">import</code> <code class="py plain">HttpResponse</code></div><div class="line number2 index1 alt1"><code class="py spaces">&nbsp;</code>&nbsp;</div><div class="line number3 index2 alt2"><code class="py keyword">def</code> <code class="py plain">index(request):</code></div><div class="line number4 index3 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py plain">HttpResponse(</code><code class="py string">"&lt;h2&gt;Главная&lt;/h2&gt;"</code><code class="py plain">)</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="py keyword">def</code> <code class="py plain">about(request):</code></div><div class="line number7 index6 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py plain">HttpResponse(</code><code class="py string">"&lt;h2&gt;О сайте&lt;/h2&gt;"</code><code class="py plain">)</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="py keyword">def</code> <code class="py plain">contact(request):</code></div><div class="line number10 index9 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py keyword">return</code> <code class="py plain">HttpResponse(</code><code class="py string">"&lt;h2&gt;Контакты&lt;/h2&gt;"</code><code class="py plain">)</code></div></div></td></tr></tbody></table></div></div>
    </nav>
    <p>И в файле <strong>urls.py</strong> они сопоставляются с адресами URL с помощью функции <strong>path()</strong>:</p>
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div><div id="highlighter_258279" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help"></a></strong></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">from</code> <code class="py plain">django.urls </code><code class="py keyword">import</code> <code class="py plain">path</code></div><div class="line number2 index1 alt1"><code class="py keyword">from</code> <code class="py plain">firstapp </code><code class="py keyword">import</code> <code class="py plain">views</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="py plain">urlpatterns </code><code class="py keyword">=</code> <code class="py plain">[</code></div><div class="line number5 index4 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">path('', views.index),</code></div><div class="line number6 index5 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">path(</code><code class="py string">'about'</code><code class="py plain">, views.about),</code></div><div class="line number7 index6 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">path(</code><code class="py string">'contact'</code><code class="py plain">, views.contact),</code></div><div class="line number8 index7 alt1"><code class="py plain">]</code></div></div></td></tr></tbody></table></div></div>
    </nav>
    <p>Функция <strong>path()</strong> располагается в пакете <span class="ii">django.urls</strong> и принимает два параметра: запрошенный адрес URL и функция, которая обрабатывает запрос по этому адресу. 
    Дополнительно через третий параметр можно указать имя маршрута:</p>
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div><div id="highlighter_756456" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help"></a></strong></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py plain">path('</code><code class="py string">', views.index, name='</code><code class="py plain">home'),</code></div></div></td></tr></tbody></table></div></div>
    </nav>
    <p>В данном случае маршрут будет называться "home".</p>
    <p>Однако функция path ограничена по своему действию. Запрошенный путь должен в точности соответствовать указанному в маршруте адресу URL. Так, в примере выше, что функция views.about могла обрабатывать запрос, адрес должен быть в точности "about". Например, стоит нам указать 
    слеш в конце: "about/" и django уже не сможет сопоставить путь с запросом.</p>
    <img class="displayed" src="{% static "images/2/3.4.png" %}" alt="site logo" >
    <h3>re_path</h3>
    <p>В качестве альтернативы для определения маршрутов мы можем использовать функцию <strong>re_path()</strong>, 
    которая также располагается в пакете django.urls. Ее преимущесто состоит в том, что она позволяет задать адреса URL с помощью регулярных выражений.</p>
    <p>Например, изменим определение файла <strong>urls.py</strong> следующим образом:</p>
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div><div id="highlighter_330022" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help"></a></strong></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">from</code> <code class="py plain">django.urls </code><code class="py keyword">import</code> <code class="py plain">path</code></div><div class="line number2 index1 alt1"><code class="py keyword">from</code> <code class="py plain">django.urls </code><code class="py keyword">import</code> <code class="py plain">re_path</code></div><div class="line number3 index2 alt2"><code class="py keyword">from</code> <code class="py plain">firstapp </code><code class="py keyword">import</code> <code class="py plain">views</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="py plain">urlpatterns </code><code class="py keyword">=</code> <code class="py plain">[</code></div><div class="line number6 index5 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">path('', views.index),</code></div><div class="line number7 index6 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">re_path(r</code><code class="py string">'^about'</code><code class="py plain">, views.about),</code></div><div class="line number8 index7 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">re_path(r</code><code class="py string">'^contact'</code><code class="py plain">, views.contact),</code></div><div class="line number9 index8 alt2"><code class="py plain">]</code></div></div></td></tr></tbody></table></div></div>
    </nav>
    <p>Адрес в первом маршруте по-прежнему образуется с помощью функции path и указывает на корень веб-приложения.</p>
    <p>Остальные два маршрута образуются с помощью функции <code>re_path()</code>. Причем, поскольку определяется регуляное выражение, то перед строкой с шаблоном 
    адреса URL ставится буква <strong>r</strong>. В самом шаблоне адреса можно использовать различные элементы синтаксиса регулярных выражений. 
    В частности, выражение <code>^about</code> указывает, что адрес должен начинаться с "about". Однако он необязательно в точности должен соответствовать 
    строке "about", как это было в случае с функцией path.</p>
    <p>Например, мы можем обратиться по любому адресу, главное чтобы он начинался с "about", и тогда подобный запрос будет обрабатываться функцией views.about.</p>
    <img class="displayed" src="{% static "images/2/3.5.png" %}" alt="site logo" >
    <h3>Очередность маршрутов</h3>
    <p>Когда запрос приходит к приложению, то система проверяет соответствие запроса маршрутам по мере их определения: вначале сравнивается первый маршрут, если он не подходит, то сравнивается второй и так далее. 
    Поэтому более общие маршруты должны определяться в последнюю очередь, а более конкретные маршруты должны идти в начале. Например:</p>
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
    <div><div id="highlighter_420032" class="syntaxhighlighter  py"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help"></a></strong></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="py keyword">from</code> <code class="py plain">django.urls </code><code class="py keyword">import</code> <code class="py plain">path</code></div><div class="line number2 index1 alt1"><code class="py keyword">from</code> <code class="py plain">django.urls </code><code class="py keyword">import</code> <code class="py plain">re_path</code></div><div class="line number3 index2 alt2"><code class="py keyword">from</code> <code class="py plain">firstapp </code><code class="py keyword">import</code> <code class="py plain">views</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="py plain">urlpatterns </code><code class="py keyword">=</code> <code class="py plain">[</code></div><div class="line number6 index5 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">re_path(r</code><code class="py string">'^about/contact/'</code><code class="py plain">, views.contact),</code></div><div class="line number7 index6 alt2"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">re_path(r</code><code class="py string">'^about'</code><code class="py plain">, views.about),</code></div><div class="line number8 index7 alt1"><code class="py spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="py plain">path('', views.index),</code></div><div class="line number9 index8 alt2"><code class="py plain">]</code></div></div></td></tr></tbody></table></div></div>
    </nav>
    <p>В данном случае адрес "^about/contact" представляет более конкретный маршрут по сравнению c "^about". Поэтому он определяется в первую очередь.</p>
    <h3>Основные элементы синтаксиса регуляных выражений</h3>
    <p>Некоторые базовые элементы регуляных выражений, которые можно использовать для определения адресов URL:</p>
    <ul>
    <li><p><code>^</code> (начало адреса)</p></li>
    <li><p><code>$</code> (конец адреса)</p></li>
    <li><p><code>+</code> (1 и более символов)</p></li>
    <li><p><code>?</code> (0 или 1 символ)</p></li>
    <li><p><code>{n}</code> (n символов)</p></li>
    <li><p><code>{n, m}</code> (от n до m символов)</p></li>
    <li><p><code>.</code> (любой символ)</p></li>
    <li><p><code>\d+</code> (одна или несколько цифр)</p></li>
    <li><p><code>\D+</code> (одна или несколько НЕ цифр)</p></li>
    <li><p><code>\w+</code> (один или несколько буквенных символов)</p></li>
    </ul>
    <p>Рассмотрим несколько возможных сопоставлений шаблонов адресов и запросов:</p>
    <img class="displayed" src="{% static "images/2/3.5.1.png" %}" alt="site logo" >
   


{% endblock %}